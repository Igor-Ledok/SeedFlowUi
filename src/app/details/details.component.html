<app-header></app-header>

  <hr>

  <div class="container">
    <img 
    *ngFor="let img of images; let i = index"
    [src]="activeIndex === i ? img.active : img.gray"
    alt="Image"
    class="image"
    [class.active]="activeIndex === i"
    (click)="onImageClick(img.link)">
  </div>

  <div class="tabs-container">
    <div class="tabs">
      <button [routerLink]="'/general-page'">{{"ЗАГАЛЬНЕ" | transloco}}</button>
      <button [routerLink]="'/detail-page'">{{"ДЕТАЛІ" | transloco}}</button>
      <button [routerLink]="'/team-page'">{{"КОМАНДА" | transloco}}</button>
      <button [routerLink]="'/rewards-page'">{{"ВИНАГОРОДИ" | transloco}}</button>
      <button [routerLink]="'/requisites-page'">{{"РЕКВІЗИТИ" | transloco}}</button>
      <button [routerLink]="'/uploads-page'">{{"ВИКЛАСТИ" | transloco}}</button>
    </div>
  </div>

  <button class="fixed-button" (click)="scrollToTop()">
    <i class="fas fa-arrow-up"></i>
  </button>

  
<div class="form-container">

 
    <div class="form-group">
        <label class="form-label">
            {{"Короткий опис" | transloco}}
        </label>
        <div class="form-row">
            <span class="form-description1">
              {{"Поясніть ідею вашого проєкту 1-2-ма реченнями" | transloco}}
            </span>
            <div class="fields">
                <div class="input-wrapper">
                    <textarea 
                    class="form-input" 
                    [(ngModel)]="projectData.ShortDescription"
                    (blur)="validateShortDescription()"
                    (input)="validateShortDescription();updateCharCount() "
                    maxlength="250"
                    ></textarea>
                    <span class="char-counter">{{ charCount }}/250</span>
                    <div *ngIf="shortDescriptionError" class="error-message">
                      {{"Поле не може бути порожнім" | transloco}}
                  </div>
                </div>
            </div>
        </div>
      </div>



      <div class="form-group">
        <label class="form-label3">
            {{"Детальний опис" | transloco}}
        </label>
        <div class="form-row">
          <span class="form-description2">
            {{"Розкажіть більш детально про Ваш проєкт. Чому доброчинці мають профінансувати саме його? Як і що зміниться, коли проєкт здійсниться?" | transloco}}
          </span>
            <div class="fields">
              <div *ngFor="let field of dynamicFields; let i = index">
                <div class="input-wrapper3">
                  <input 
                  type="text" 
                  class="form-input"  
                  placeholder='{{"Підзаголовок" | transloco}}'
                  [(ngModel)]="field.titleDetailedDescription"
                  (blur)="validateDetailedDescription(i, 'titleDetailedDescription')" 
                  (input)="validateDetailedDescription(i, 'titleDetailedDescription')"/>
                  <div *ngIf="field.subtitleError" class="error-message">
                    {{"Підзаголовок не може бути порожнім" | transloco}}
                  </div>
                </div>

                <div class="input-wrapper4">
                    <textarea 
                    class="form-input2"  
                    [(ngModel)]="field.detailedDescription"
                    (blur)="validateDetailedDescription(i, 'detailedDescription')" 
                    (input)="validateDetailedDescription(i, 'detailedDescription'); updateCharCount2(i)"
                    maxlength="1000"
                    placeholder='{{"Текст" | transloco}}'
                    ></textarea>
                  <span class="char-counter2">{{ field.charCount2 }}/1000</span>
                  <div *ngIf="field.descriptionError" class="error-message">
                    {{"Текст не може бути порожнім" | transloco}}
                  </div>
                </div>
                
              </div>
            <button class="add-field-button" (click)="addField()">+</button>
          </div>
        </div>
      </div>



    <div class="form-group">
        <label class="form-label4">{{"Додаткові фото" | transloco}}</label>
        <div class="form-row">
          <span class="form-description">
            {{"Викладіть додаткові фото або зображення, щоб краще візуалізувати ідею проєкту" | transloco}}
          </span>
          <div class="fields">
            <div class="photo-gallery">
              <div *ngFor="let photo of projectPhotos; let i = index" class="photo-item">
                <img [src]="photo" alt="Зображення проєкту" class="photo-preview" />
                <div class="photo-buttons">
                  <button class="btn-remove" (click)="removePhoto(i)">✖ {{"Видалити" | transloco}}</button>
                </div>
              </div>
            </div>
            
            <div class="file-upload">
               <input type="file" class="file-input" id="additionalPhotos" multiple (change)="onFilesSelected($event)" />
              <label for="additionalPhotos" class="file-label">
                {{"Завантажити файл" | transloco}} (JPEG, JPG, PNG)
              </label>
            </div>
          </div>
        </div>
      </div>
      

      <div class="form-group">
        <label class="form-label5">{{ "Статті бюджету" | transloco }}</label>
        <div class="form-row">
          <span class="form-description3">
            {{ "Розкажіть, як Ви плануєте витратити кошти, зібрані на платформі для реалізації свого проєкту. Вкажіть інші джерела фінансування, якщо такі маєте.Заповніть відповідне поле або завантажте файл." | transloco }}
          </span>
      
          <div class="fields">
            <!-- Текстовое поле -->
            <div class="input-wrapper2">
              <textarea
                class="form-input2"
                [(ngModel)]="projectData.BudgetArticles"
                (input)="updateBudgetCharCount(); validateBudget()"
                (blur)="validateBudget()"
                maxlength="1000"
                placeholder="{{ 'Детальний опис витрат' | transloco }}"
              ></textarea>
              <span class="char-counter2">{{ budgetCharCount }}/1000</span>
      
              <div *ngIf="isValidationDone && budgetError" class="error-message">
                {{ "Вкажіть текст або завантажте файл (Word, PDF, doc)" | transloco }}
              </div>
            </div>
      
            <!-- Загрузка файла -->
            <div class="file-upload">
              <input
                type="file"
                class="file-input"
                id="budget-file"
                (change)="onFileSelected($event)"
                accept=".doc,.docx,.pdf"
              />
              <label for="budget-file" class="file-label">
                {{ "Завантажити файл" | transloco }} (Word, PDF, doc)
              </label>
            </div>
            <div *ngIf="projectData.BudgetArticlesFileName" class="file-info">
              <p class="docx2">{{ projectData.BudgetArticlesFileName }}</p>
              <button (click)="clearFile()" class="remove-button">
                {{"Видалити файл" | transloco}}
              </button>
            </div>
          </div>
        </div>
      </div>

    <div class="form-group">
        <label class="form-label6">{{"Контакти" | transloco}}</label>
        <div class="form-row">
            <span class="form-description4">{{"Вкажіть контакти, за якими з Вами можна зв'язатись(телефон, viber, telegram, тощо)" | transloco}}</span>
            <div class="fields">
                <div class="input-wrapper">
                  <div class="icon-container">
                  <i class="fa-solid fa-phone icon"></i>
                  </div>
                    <input 
                    type="text" 
                    class="form-input" 
                    placeholder="{{'Номер телефона' | transloco}}" 
                    [(ngModel)]="phone"
                    (input)="validatePhone()"
                    (blur)="validatePhone()"
                    [ngClass]="{'error': phoneError}"/>
                    <div *ngIf="phoneError" class="error-message">
                      {{ "Невірний формат номера телефону" | transloco }}
                    </div>
                </div>
                <div class="input-wrapper">
                  <div class="icon-container">
                  <i class="fa-brands fa-telegram icon"></i>
                  </div>
                    <input type="text" class="form-input" placeholder="Telegram" [(ngModel)]="projectData.Telegram"/>
                </div>
                <div class="input-wrapper">
                  <div class="icon-container">
                  <i class="fa-brands fa-viber icon"></i>
                  </div>
                    <input type="text" class="form-input" placeholder="Viber" [(ngModel)]="projectData.Viber"/>
                </div>
                <div class="input-wrapper">
                  <div class="icon-container">
                  <i class="fa-brands fa-whatsapp icon"></i>
                  </div>
                    <input type="text" class="form-input" placeholder="WhatsApp" [(ngModel)]="projectData.WhatsApp" />
                </div>
                <div class="input-wrapper">
                  <div class="icon-container">
                  <i class="fa-brands fa-whatsapp icon"></i>
                  </div>
                    <input type="text" class="form-input" placeholder="linkedIn" [(ngModel)]="projectData.LinkedIn" />
                </div>
            </div>
        </div>
    </div>

    <div class="form-group">
        <label class="form-label7">{{"Електронна адреса" | transloco}}</label>
        <div class="form-row">
            <span class="form-description">{{"Вкажіть актуальну електронну адресу" | transloco}}</span>
            <div class="fields">
                <div class="input-wrapper">
                    <input 
                      type="email" 
                      class="form-input" 
                      [(ngModel)]="projectData.Email"
                      (input)="validateEmail()"
                      (blur)="validateEmail()"
                      [ngClass]="{'error': emailError}"
                      />
                      <div *ngIf="emailError" class="error-message">
                        {{ "Електронна адреса не може бути порожньою та повинна бути правильною" | transloco }}
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="form-group">
        <label class="form-label8">{{"Місто" | transloco}}</label>
        <div class="form-row">
            <span class="form-description">{{"Вкажіть місто, де працюватиме команда проєкту" | transloco}}</span>
            <div class="fields">
                <div class="input-wrapper">
                    <input 
                    type="text" 
                    class="form-input" 
                    [(ngModel)]="projectData.Address"
                    (input)="validateCity()"
                    (blur)="validateCity()"
                    />
                    <div *ngIf="cityError" class="error-message">
                      {{ "Місто не може бути порожнім та повинно починатись з великої літери" | transloco }}
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="form-group">
        <label class="form-label8">{{"Соцмережі" | transloco}}</label>
        <div class="form-row">
            <span class="form-description5">{{"Додайте посилання на сторінки Вашого проєкту в соціальних мережах" | transloco}}</span>
            <div class="fields">
                <div class="input-wrapper">
                  <div class="icon-container">
                    <i class="fa-brands fa-instagram icon"></i>
                  </div>
                    <input type="text" class="form-input" placeholder="Instagram" [(ngModel)]="projectData.Instagram"/>
                </div>
                <div class="input-wrapper">
                  <div class="icon-container">
                    <i class="fa-brands fa-youtube icon"></i>
                  </div>
                  <input type="text" class="form-input" placeholder="Youtube" [(ngModel)]="projectData.YouTubeVideoUrl"/>
                </div>
                <div class="input-wrapper">
                  <div class="icon-container">
                    <i class="fa-brands fa-telegram icon"></i>
                  </div>
                  <input type="text" class="form-input" placeholder="Telegram" [(ngModel)]="projectData.TelegramChannel"/>
                </div>
                <div class="input-wrapper">
                  <div class="icon-container">
                    <i class="fa-brands fa-facebook icon"></i>
                  </div>
                    <input type="text" class="form-input" placeholder="Facebook" [(ngModel)]="projectData.Facebook"/>
                </div>
                <div class="input-wrapper">
                  <div class="icon-container">
                    <i class="fa-brands fa-twitter icon"></i>
                  </div>
                    <input type="text" class="form-input" placeholder="Twitter" [(ngModel)]="projectData.Twitter"/>
                </div>
                <div class="input-wrapper">
                  <div class="icon-container">
                    <i class="fa-brands fa-linkedin icon"></i>
                  </div>
                    <input type="text" class="form-input" placeholder="LinkedIn" [(ngModel)]="projectData.LinkedInGroup"/>
                </div>
            </div>
        </div>
    </div>

    <div class="form-buttons">
        <button class="btn btn-secondary" (click)="saveDetailData()">{{"ЗБЕРЕГТИ ЗМІНИ" | transloco}}</button>
        <button class="btn btn-primary" (click)="submitProject()">{{"ДАЛІ" | transloco}}</button>
    </div>

    <div *ngIf="isPopupOpen" class="popup-window2" (click)="closePopup()">
      <div class="popup-content2" (click)="$event.stopPropagation()">
        
        <div class="popup-message2">
          <img src="assets/images/WhitePig.png" class="popup-image2" alt="Success">
          <p class="popup-text2">{{"Зміни у проєкті успішно збережено" | transloco}}</p>
        </div>
      </div>
    </div>
</div>

<app-footer></app-footer>